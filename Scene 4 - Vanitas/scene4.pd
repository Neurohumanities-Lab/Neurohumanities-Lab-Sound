#N canvas 3739 207 2400 1226 12;
#X declare -path ./abs;
#X obj 310 7 adc~ 1;
#X obj 485 121 env~;
#X floatatom 485 145 5 0 0 0 - - - 0;
#X msg 162 141 open ./voz.wav \, start;
#X obj 232 201 writesf~;
#X msg 190 97 stop;
#X msg 414 184 open ./voz.wav \, start;
#X obj 414 217 readsf~;
#X obj 729 494 *~ 0.9;
#X obj 729 518 else/drive~;
#X obj 729 542 hip~ 3;
#X obj 729 566 *~ 0.9;
#X obj 729 590 dac~ 1 2;
#X msg 297 191 stop;
#X obj -194 33 declare -path ./abs;
#X obj 414 251 audiolab/pp.fft-pitchshift~;
#A saved empty_slot \; empty_slot \; empty_slot \; empty_slot \; empty_slot \; empty_slot \; empty_slot \; empty_slot \; empty_slot \; empty_slot \; empty_slot \; empty_slot \; empty_slot \; empty_slot \; empty_slot \; empty_slot \; empty_slot \; empty_slot \; empty_slot \; empty_slot \; empty_slot \;;
#X obj 847 375 else/plate.rev~;
#X obj 847 399 +~;
#X msg 912 343 wet 0.4 \, size 0.6 \, damp 0.5 \, pre 0;
#X obj 274 435 *~ 0.2;
#X obj 408 481 else/lowpass~ 4000 0.4;
#X obj 646 231 hsl 162 19 0 127 0 1 empty empty Boca -2 -10 0 12 #00ff04 #000000 #000000 16100 1;
#X floatatom 753 271 5 0 0 0 - - - 0;
#X msg 753 294 135 \$1;
#X obj 753 318 -;
#X floatatom 753 342 5 0 0 0 - - - 0;
#X obj 644 255 / 127;
#X obj 572 392 + 35;
#X obj 572 368 * 100;
#X obj 572 416 mtof;
#X obj 572 440 else/f2s~ 100;
#X floatatom 643 359 5 0 0 0 - - - 0;
#X obj 644 279 pow 4;
#X obj 283 319 -~ 0.02;
#X obj 292 347 else/eq~ 2000 100 20;
#X obj 284 374 else/drive~ 60;
#X obj 274 412 hip~ 100;
#X obj 54 356 audiolab/pp.fft-pitchshift~;
#A saved empty_slot \; empty_slot \; empty_slot \; empty_slot \; empty_slot \; empty_slot \; empty_slot \; empty_slot \; empty_slot \; empty_slot \; empty_slot \; empty_slot \; empty_slot \; empty_slot \; empty_slot \; empty_slot \; empty_slot \; empty_slot \; empty_slot \; empty_slot \; empty_slot \;;
#N canvas 114 114 1920 956 fear 0;
#X obj 109 559 audiolab/pp.fft-timbre~ 512 4;
#A saved empty_slot \; empty_slot \; empty_slot \; empty_slot \; empty_slot \; empty_slot \; empty_slot \; empty_slot \; empty_slot \; empty_slot \; empty_slot \; empty_slot \; empty_slot \; empty_slot \; empty_slot \; empty_slot \; empty_slot \; empty_slot \; empty_slot \; empty_slot \; empty_slot \;;
#X obj 71 336 else/highpass~ 300 0.4;
#X obj 144 395 loadbang;
#X obj 85 258 inlet~;
#X obj 105 785 outlet~;
#X obj 108 695 else/lowpass~ 4000 0.4;
#X obj 75 364 else/highpass~ 1000 0.4;
#X msg 127 477 curve-1 330 \, breakpoint-1 47 \, curve-2 533 \, breakpoint-2 26 \, rotate -78 \, shift 375 \, gain 20 \, dry/wet 90;
#X obj 105 668 else/highshelf~ 3000 0.4 9;
#X connect 0 0 8 0;
#X connect 1 0 6 0;
#X connect 2 0 7 0;
#X connect 3 0 1 0;
#X connect 5 0 4 0;
#X connect 6 0 0 0;
#X connect 7 0 0 1;
#X connect 8 0 5 0;
#X restore 84 548 pd fear;
#X obj 270 542 s~ vox;
#N canvas 352 24 545 673 fft-analysis 0;
#X obj 92 534 *~;
#X obj 53 534 *~;
#X obj 330 325 *~;
#X obj 298 325 *~;
#X obj 298 351 +~;
#X obj 53 176 *~;
#X obj 53 151 inlet~;
#X obj 53 199 rfft~;
#X obj 53 603 *~;
#X obj 144 238 *~;
#X obj 298 297 rfft~;
#X obj 53 568 rifft~;
#X obj 53 636 outlet~;
#X obj 110 238 *~;
#X obj 110 261 +~;
#X text 379 355 modulus;
#X obj 110 443 *~;
#X obj 357 459 block~ 1024 4;
#X obj 110 391 clip~;
#X obj 86 177 tabreceive~ \$0-hann;
#X obj 356 499 loadbang;
#X obj 143 342 r squelch;
#X obj 142 365 expr 0.01*$f1*$f1;
#X obj 110 287 +~ 1e-20;
#X obj 110 503 *~ 0.00065;
#X obj 86 603 tabreceive~ \$0-hann;
#X obj 298 268 *~;
#X obj 298 239 inlet~;
#X obj 331 269 tabreceive~ \$0-hann;
#X text 379 372 of control;
#X text 377 389 amplitude;
#X text 187 242 reciprocal;
#X text 190 261 modulus of;
#X text 186 281 filter input;
#X text 187 300 amplitude;
#X text 114 152 filter input;
#X text 363 239 control source;
#X text 360 296 Fourier transform;
#X text 43 19 Internal workings of the timbre stamping algorithm. First the "filter input" is treated as in the compressor patch \, multiplying each channel amplitude by one over its modulus (but limited by the "squelch" parameter.) It is then multiplied by the modulus of the channel amplitude for the control source (which is Fourier analyzed in parallel with the filter input.);
#X text 148 440 multiply the two amplitude;
#X text 146 457 factors (for compression;
#X text 148 473 and to apply new timbre);
#X msg 356 522 \; window-size 1024 \; squelch 30 \; squelch-set set 30;
#X obj 110 314 rsqrt~;
#X obj 298 374 sqrt~;
#X connect 0 0 11 1;
#X connect 1 0 11 0;
#X connect 2 0 4 1;
#X connect 3 0 4 0;
#X connect 4 0 44 0;
#X connect 5 0 7 0;
#X connect 6 0 5 0;
#X connect 7 0 13 0;
#X connect 7 0 13 1;
#X connect 7 0 1 0;
#X connect 7 1 9 0;
#X connect 7 1 9 1;
#X connect 7 1 0 0;
#X connect 8 0 12 0;
#X connect 9 0 14 1;
#X connect 10 0 3 0;
#X connect 10 0 3 1;
#X connect 10 1 2 0;
#X connect 10 1 2 1;
#X connect 11 0 8 0;
#X connect 13 0 14 0;
#X connect 14 0 23 0;
#X connect 16 0 24 0;
#X connect 18 0 16 0;
#X connect 19 0 5 1;
#X connect 20 0 42 0;
#X connect 21 0 22 0;
#X connect 22 0 18 2;
#X connect 23 0 43 0;
#X connect 24 0 0 1;
#X connect 24 0 1 1;
#X connect 25 0 8 1;
#X connect 26 0 10 0;
#X connect 27 0 26 0;
#X connect 28 0 26 1;
#X connect 43 0 18 0;
#X connect 44 0 16 1;
#X restore 339 730 pd fft-analysis;
#X text 459 724 source;
#N canvas 163 152 567 523 hann-window 0;
#N canvas 0 0 450 300 (subpatch) 0;
#X array \$0-hann 1024 float 0;
#X coords 0 1 1023 0 300 100 1;
#X restore 110 394 graph;
#X obj 327 184 osc~;
#X obj 327 209 *~ -0.5;
#X obj 327 233 +~ 0.5;
#X obj 310 276 tabwrite~ \$0-hann;
#X obj 86 113 r window-size;
#X obj 157 237 /;
#X obj 175 205 samplerate~;
#X obj 157 315 s window-sec;
#X obj 67 251 swap;
#X obj 67 275 /;
#X obj 67 299 s window-hz;
#X obj 168 265 * 1000;
#X obj 168 292 s window-msec;
#X obj 86 148 t f b f;
#X msg 175 155 resize \$1;
#X obj 175 179 s \$0-hann;
#X obj 279 122 r window-hz;
#X msg 352 154 0;
#X obj 279 150 t f b;
#X text 56 20 calculate Hann window table (variable window size) and constants window-hz (fundamental frequency of analysis) \, window-sec and window-msec (analysis window size in seconds and msec)., f 56;
#X connect 1 0 2 0;
#X connect 2 0 3 0;
#X connect 3 0 4 0;
#X connect 5 0 14 0;
#X connect 6 0 8 0;
#X connect 6 0 12 0;
#X connect 7 0 6 1;
#X connect 7 0 9 1;
#X connect 9 0 10 0;
#X connect 9 1 10 1;
#X connect 10 0 11 0;
#X connect 12 0 13 0;
#X connect 14 0 6 0;
#X connect 14 0 9 0;
#X connect 14 1 7 0;
#X connect 14 2 15 0;
#X connect 15 0 16 0;
#X connect 17 0 19 0;
#X connect 18 0 1 1;
#X connect 19 0 1 0;
#X connect 19 1 4 0;
#X connect 19 1 18 0;
#X restore 529 736 pd hann-window;
#X obj 499 654 else/pulse~ 10;
#X obj 380 435 *~ 0.1;
#X obj 148 226 phasor~ 1.5;
#X obj 160 260 lop~ 100;
#X obj 184 329 +~ 100;
#X obj 53 170 delwrite~ \$0-vibrato 500;
#X obj 53 267 +~ 10;
#X obj 53 293 delread4~ \$0-vibrato;
#X obj 51 214 osc~ 6;
#X obj 189 305 *~ -300;
#X obj 52 241 *~ 2;
#X obj 940 672 audiolab/pp.fft-pitchshift~;
#A saved empty_slot \; empty_slot \; empty_slot \; empty_slot \; empty_slot \; empty_slot \; empty_slot \; empty_slot \; empty_slot \; empty_slot \; empty_slot \; empty_slot \; empty_slot \; empty_slot \; empty_slot \; empty_slot \; empty_slot \; empty_slot \; empty_slot \; empty_slot \; empty_slot \;;
#X obj 1070 646 +~ 0;
#X obj 1075 623 *~ 500;
#X obj 1046 576 lop~ 10000;
#X obj 1032 523 phasor~ 5;
#X connect 0 0 1 0;
#X connect 0 0 4 0;
#X connect 1 0 2 0;
#X connect 3 0 4 0;
#X connect 5 0 4 0;
#X connect 6 0 7 0;
#X connect 7 0 15 0;
#X connect 7 0 38 0;
#X connect 7 0 39 0;
#X connect 7 0 40 1;
#X connect 7 0 44 0;
#X connect 7 0 48 0;
#X connect 7 0 54 0;
#X connect 7 1 6 0;
#X connect 8 0 9 0;
#X connect 9 0 10 0;
#X connect 10 0 11 0;
#X connect 11 0 12 0;
#X connect 11 0 12 1;
#X connect 13 0 7 0;
#X connect 15 0 33 0;
#X connect 16 0 17 0;
#X connect 16 1 17 1;
#X connect 17 0 8 0;
#X connect 18 0 16 0;
#X connect 20 0 8 0;
#X connect 21 0 26 0;
#X connect 22 0 23 0;
#X connect 23 0 24 0;
#X connect 24 0 25 0;
#X connect 26 0 32 0;
#X connect 27 0 29 0;
#X connect 28 0 27 0;
#X connect 29 0 30 0;
#X connect 29 0 31 0;
#X connect 30 0 20 1;
#X connect 32 0 28 0;
#X connect 33 0 34 0;
#X connect 34 0 35 0;
#X connect 35 0 36 0;
#X connect 36 0 19 0;
#X connect 43 0 40 0;
#X connect 45 0 46 0;
#X connect 46 0 52 0;
#X connect 47 0 37 1;
#X connect 49 0 50 0;
#X connect 50 0 37 0;
#X connect 51 0 53 0;
#X connect 52 0 47 0;
#X connect 53 0 49 0;
#X connect 55 0 54 1;
#X connect 56 0 55 0;
#X connect 57 0 56 0;
#X connect 58 0 57 0;
